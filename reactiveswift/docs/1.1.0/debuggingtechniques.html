<!DOCTYPE html>
<html lang="en">
  <head>
    <title>DebuggingTechniques  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="DebuggingTechniques  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          ReactiveSwift Docs
        </a>
        
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/ReactiveCocoa/ReactiveSwift/">
            <img class="header-icon" src="img/gh.png"/>
            View on GitHub
          </a>
        </p>
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">ReactiveSwift Reference</a>
      <img class="carat" src="img/carat.png" />
      DebuggingTechniques  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Getting Started.html">Getting Started</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="basicoperators.html">BasicOperators</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="frameworkoverview.html">FrameworkOverview</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="debuggingtechniques.html">DebuggingTechniques</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="designguidelines.html">DesignGuidelines</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Signal.html">Signal</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/Event.html">Event</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/EventProtocol.html">EventProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Observer.html">Observer</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ObserverProtocol.html">ObserverProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Signal.html">Signal</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/SignalProtocol.html">SignalProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/FlattenStrategy.html">FlattenStrategy</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="SignalProducer.html">SignalProducer</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/SignalProducer.html">SignalProducer</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/SignalProducerProtocol.html">SignalProducerProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="SignalProducer.html#/s:F13ReactiveSwift5timerFT8intervalO8Dispatch20DispatchTimeInterval2onPS_13DateScheduler__GVS_14SignalProducerV10Foundation4DateO6Result7NoError_">timer(interval:on:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="SignalProducer.html#/s:F13ReactiveSwift5timerFT8intervalO8Dispatch20DispatchTimeInterval2onPS_13DateScheduler_6leewayS1__GVS_14SignalProducerV10Foundation4DateO6Result7NoError_">timer(interval:on:leeway:)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Property.html">Property</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Property.html">Property</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/PropertyProtocol.html">PropertyProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MutableProperty.html">MutableProperty</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MutablePropertyProtocol.html">MutablePropertyProtocol</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Action.html">Action</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Action.html">Action</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/ActionError.html">ActionError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ActionProtocol.html">ActionProtocol</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Bindings.html">Bindings</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/BindingTarget.html">BindingTarget</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Bindings.html#/s:F13ReactiveSwiftoi2ltu0_RxS_21BindingTargetProvider_S_13BindingSourcewx5Valuezw_5Valuew_5ErrorzO6Result7NoErrorrFTxq__GSqPS_10Disposable__">&lt;~(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Bindings.html#/s:F13ReactiveSwiftoi2ltu0_RxS_21BindingTargetProvider_S_13BindingSourcewx5ValueS_16OptionalProtocolw_5ErrorzO6Result7NoErrorw_5ValuezWxS2_7Wrapped_rFTxq__GSqPS_10Disposable__">&lt;~(_:_:)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Schedulers.html">Schedulers</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ImmediateScheduler.html">ImmediateScheduler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/QueueScheduler.html">QueueScheduler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/TestScheduler.html">TestScheduler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/UIScheduler.html">UIScheduler</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Reactive Extensions.html">Reactive Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Reactive.html">Reactive</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ReactiveExtensionsProvider.html">ReactiveExtensionsProvider</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Lifetime.html">Lifetime</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Lifetime.html">Lifetime</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Lifetime.html#/s:CC13ReactiveSwift8Lifetime5Token">– Token</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Disposable.html">Disposable</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/AnyDisposable.html">AnyDisposable</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ActionDisposable.html">ActionDisposable</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/Disposable.html">Disposable</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CompositeDisposable.html">CompositeDisposable</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CompositeDisposable/DisposableHandle.html">– DisposableHandle</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ScopedDisposable.html">ScopedDisposable</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/SerialDisposable.html">SerialDisposable</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/SimpleDisposable.html">SimpleDisposable</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Disposable.html#/s:F13ReactiveSwiftoi2peFTCS_19CompositeDisposableGSqPS_10Disposable___CS0_16DisposableHandle">+=(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Disposable.html#/s:F13ReactiveSwiftoi2peFTCS_19CompositeDisposableFT_T__CS0_16DisposableHandle">+=(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Disposable.html#/s:F13ReactiveSwiftoi2peFTGCS_16ScopedDisposableCS_19CompositeDisposable_GSqPS_10Disposable___CS1_16DisposableHandle">+=(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Disposable.html#/s:F13ReactiveSwiftoi2peFTGCS_16ScopedDisposableCS_19CompositeDisposable_FT_T__CS1_16DisposableHandle">+=(_:_:)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Utilities.html">Utilities</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Atomic.html">Atomic</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/AtomicProtocol.html">AtomicProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Bag.html">Bag</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/BagIterator.html">BagIterator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Utilities.html#/s:C13ReactiveSwift12RemovalToken">RemovalToken</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Utilities.html#/s:13ReactiveSwift11EventLogger">EventLogger</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Utilities.html#/s:O13ReactiveSwift12LoggingEvent">LoggingEvent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Optional.html">Optional</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/OptionalProtocol.html">OptionalProtocol</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Classes.html">Other Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ValidatingProperty.html">ValidatingProperty</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Enums.html">Other Enums</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/ValidationResult.html">ValidationResult</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/ValidatorOutput.html">ValidatorOutput</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Protocols.html">Other Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/BindingSource.html">BindingSource</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other Protocols.html#/s:P13ReactiveSwift21BindingTargetProvider">BindingTargetProvider</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ComposableMutablePropertyProtocol.html">ComposableMutablePropertyProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/DateScheduler.html">DateScheduler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/Scheduler.html">Scheduler</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content">
            
            <a href='#debugging-techniques' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='debugging-techniques'>Debugging Techniques</h1>

<p>This document lists debugging techniques and infrastructure helpful for debugging ReactiveCocoa applications.</p>
<a href='#unscrambling-swift-compiler-errors' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='unscrambling-swift-compiler-errors'>Unscrambling Swift compiler errors</h4>

<p>Type inferrence can be a source of hard-to-debug compiler errors. There are two potential places to be wrong when type inferrence used:</p>

<ol>
<li>Definition of type inferred variable</li>
<li>Consumption of type inferred variable</li>
</ol>

<p>In both cases errors are related to incorrect assumptions about type. Such issues are common for ReactiveCocoa applications as it is all about operations over data and related types. The current state of the Swift compiler can cause misleading type errors, especially when error happens in the middle of a signal chain. </p>

<p>Below is an example of type-error scenario:</p>
<pre class="highlight swift"><code><span class="kt">SignalProducer</span><span class="o">&lt;</span><span class="kt">Int</span><span class="p">,</span> <span class="kt">NoError</span><span class="o">&gt;</span><span class="p">(</span><span class="nv">value</span><span class="p">:</span><span class="mi">42</span><span class="p">)</span>
    <span class="o">.</span><span class="nf">on</span><span class="p">(</span><span class="nv">value</span><span class="p">:</span> <span class="p">{</span> <span class="n">answer</span> <span class="k">in</span>
        <span class="k">return</span> <span class="n">_</span>
    <span class="p">})</span>
    <span class="o">.</span><span class="n">startWithCompleted</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Completed."</span><span class="p">)</span>
    <span class="p">}</span>
</code></pre>

<p>The code above will not compile with the following error on the <code>.startWithCompleted</code> call `error: cannot convert value of type &lsquo;Disposable&rsquo; to closure result type &lsquo;()&rsquo;. To find the actual compile error, the chain needs to be broken apart. Add explicit definitions of closure types on each of the steps:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">initialProducer</span> <span class="o">=</span> <span class="kt">SignalProducer</span><span class="o">&lt;</span><span class="kt">Int</span><span class="p">,</span> <span class="kt">NoError</span><span class="o">&gt;.</span><span class="nf">init</span><span class="p">(</span><span class="nv">value</span><span class="p">:</span><span class="mi">42</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">sideEffectProducer</span> <span class="o">=</span> <span class="n">initialProducer</span><span class="o">.</span><span class="nf">on</span><span class="p">(</span><span class="nv">value</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="nv">answer</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="k">in</span>
    <span class="k">return</span> <span class="n">_</span>
<span class="p">})</span>
<span class="k">let</span> <span class="nv">disposable</span> <span class="o">=</span> <span class="n">sideEffectProducer</span><span class="o">.</span><span class="n">startWithCompleted</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Completed."</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p>The code above will not compile too, but with the error <code>error: cannot convert value of type &#39;(Int) -&gt; _&#39; to expected argument type &#39;((Int) -&gt; Void)?&#39;</code> on definition of <code>on</code> closure. This gives enough of information to locate unexpected <code>return _</code> since <code>on</code> closure should not have any return value.</p>
<a href='#debugging-event-streams' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='debugging-event-streams'>Debugging event streams</h4>

<p>As mentioned in the README, stream debugging can be quite difficut and tedious, so we provide the <code>logEvents</code> operator. In its  simplest form:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">property</span> <span class="o">=</span> <span class="kt">MutableProperty</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">(</span><span class="s">""</span><span class="p">)</span>
<span class="o">...</span>
<span class="k">let</span> <span class="nv">searchString</span> <span class="o">=</span> <span class="n">property</span><span class="o">.</span><span class="n">producer</span>
    <span class="o">.</span><span class="nf">throttle</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="nv">on</span><span class="p">:</span> <span class="kt">QueueScheduler</span><span class="o">.</span><span class="n">main</span><span class="p">)</span>
    <span class="o">.</span><span class="nf">logEvents</span><span class="p">()</span>
</code></pre>

<p>This will print to the standard output the events. For most use cases, this is enough and will greatly help you understand your flow. 
The biggest problem with this approach, is that it will continue to ouput in Release mode. This leaves with you with two options:</p>

<ol>
<li>Comment out the operator: <code>//.logEvents()</code>. This is the simpleste approach, but it&rsquo;s error prone, since you will eventually forget to do this.</li>
<li>Pass your own function and manipulate the output as you see fit. This is the recommended approach.</li>
</ol>

<p>Let&rsquo;s see how this would look like if we didn&rsquo;t want to print in Release mode:</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">debugLog</span><span class="p">(</span><span class="nv">identifier</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">event</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">fileName</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">functionName</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">lineNumber</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="p">{</span>
   <span class="c1">// Don't forget to set up the DEBUG symbol (http://stackoverflow.com/a/24112024/491239)</span>
   <span class="cp">#if DEBUG</span>
      <span class="nf">print</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
   <span class="cp">#endif</span>
<span class="p">}</span>
</code></pre>

<p>You would then:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">property</span> <span class="o">=</span> <span class="kt">MutableProperty</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">(</span><span class="s">""</span><span class="p">)</span>
<span class="o">...</span>
<span class="k">let</span> <span class="nv">searchString</span> <span class="o">=</span> <span class="n">property</span><span class="o">.</span><span class="n">producer</span>
    <span class="o">.</span><span class="nf">throttle</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="nv">on</span><span class="p">:</span> <span class="kt">QueueScheduler</span><span class="o">.</span><span class="n">main</span><span class="p">)</span>
    <span class="o">.</span><span class="nf">logEvents</span><span class="p">(</span><span class="nv">logger</span><span class="p">:</span> <span class="n">debugLog</span><span class="p">)</span>
</code></pre>

<p>We also provide the <code>identifier</code> parameter. This is useful when you are debugging multiple streams and you don&rsquo;t want to get lost:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">property</span> <span class="o">=</span> <span class="kt">MutableProperty</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">(</span><span class="s">""</span><span class="p">)</span>
<span class="o">...</span>
<span class="k">let</span> <span class="nv">searchString</span> <span class="o">=</span> <span class="n">property</span><span class="o">.</span><span class="n">producer</span>
    <span class="o">.</span><span class="nf">throttle</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="nv">on</span><span class="p">:</span> <span class="kt">QueueScheduler</span><span class="o">.</span><span class="n">main</span><span class="p">)</span>
    <span class="o">.</span><span class="nf">logEvents</span><span class="p">(</span><span class="nv">identifier</span><span class="p">:</span> <span class="s">"✨My awesome stream ✨"</span><span class="p">)</span>
</code></pre>

<p>There also cases, specially with <a href="../Sources/Signal.swift">hot signals</a>, when there is simply too much output. For those, you can specify which events you are interested in:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">property</span> <span class="o">=</span> <span class="kt">MutableProperty</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">(</span><span class="s">""</span><span class="p">)</span>
<span class="o">...</span>
<span class="k">let</span> <span class="nv">searchString</span> <span class="o">=</span> <span class="n">property</span><span class="o">.</span><span class="n">producer</span>
    <span class="o">.</span><span class="nf">throttle</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="nv">on</span><span class="p">:</span> <span class="kt">QueueScheduler</span><span class="o">.</span><span class="n">main</span><span class="p">)</span>
    <span class="o">.</span><span class="nf">logEvents</span><span class="p">(</span><span class="nv">events</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="n">disposed</span><span class="p">])</span> <span class="c1">// This will happen when `property` is released</span>
</code></pre>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2017 <a class="link" href="https://reactivecocoa.io/" target="_blank" rel="external">ReactiveCocoa</a>. All rights reserved. (Last updated: 2017-03-28)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.7.5</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
